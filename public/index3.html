<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Management System</title>
    <style>
        :root {
    --primary-color: #2563eb;
    --primary-dark: #1d4ed8;
    --background-color: #f8fafc;
    --text-color: #1e293b;
    --border-color: #e2e8f0;
    --error-color: #ef4444;
    --success-color: #22c55e;
  }
  
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: "Inter", -apple-system, BlinkMacSystemFont, sans-serif;
  }
  
  body {
    background: var(--background-color);
    color: var(--text-color);
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  .container {
    width: 100%;
    max-width: 450px;
    padding: 2rem;
  }
  
  .welcome-screen {
    text-align: center;
    animation: fadeIn 0.5s ease-out;
  }
  
  .welcome-title {
    font-size: 2.5rem;
    margin-bottom: 2rem;
    color: var(--primary-color);
  }
  
  .btn-welcome {
    font-size: 1.25rem;
    padding: 1rem 2rem;
    background: var(--primary-color);
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    transition: all 0.3s ease;
  }
  
  .btn-welcome:hover {
    background: var(--primary-dark);
    transform: translateY(-2px);
  }
  
  .arrow {
    transition: transform 0.3s ease;
  }
  
  .btn-welcome:hover .arrow {
    transform: translateX(5px);
  }
  
  .form-container {
    background: white;
    padding: 2rem;
    border-radius: 12px;
    box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
  }
  
  .form-title {
    font-size: 1.875rem;
    margin-bottom: 2rem;
    text-align: center;
    color: var(--text-color);
  }
  
  .input-group {
    position: relative;
    margin-bottom: 1.5rem;
  }
  
  .input-group input,
  .input-group select {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    font-size: 1rem;
    transition: all 0.3s ease;
  }
  
  .input-group label {
    position: absolute;
    left: 0.75rem;
    top: 0.75rem;
    color: #64748b;
    transition: all 0.3s ease;
    pointer-events: none;
  }
  
  .input-group input:focus,
  .input-group select:focus {
    border-color: var(--primary-color);
    outline: none;
  }
  
  .input-group input:focus + label,
  .input-group input:not(:placeholder-shown) + label {
    transform: translateY(-1.5rem);
    font-size: 0.875rem;
    color: var(--primary-color);
  }
  
  .btn-submit {
    width: 100%;
    padding: 0.75rem;
    background: var(--primary-color);
    color: white;
    border: none;
    border-radius: 6px;
    font-size: 1rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    transition: all 0.3s ease;
  }
  
  .btn-submit:hover {
    background: var(--primary-dark);
  }
  
  .btn-link {
    background: none;
    border: none;
    color: var(--primary-color);
    cursor: pointer;
    font-size: inherit;
  }
  
  .btn-link:hover {
    text-decoration: underline;
  }
  
  .btn-back {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    background: none;
    border: none;
    color: var(--text-color);
    cursor: pointer;
    margin-top: 1rem;
    padding: 0.5rem;
    transition: all 0.3s ease;
  }
  
  .btn-back:hover {
    color: var(--primary-color);
  }
  
  .hidden {
    display: none;
  }
  
  .signup-text {
    text-align: center;
    margin-top: 1rem;
  }
  
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  @keyframes slideIn {
    from {
      opacity: 0;
      transform: translateX(50px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }
  
  .login-screen,
  .signup-screen {
    animation: slideIn 0.5s ease-out;
  }
  
  .input-group .select-label {
    display: block;
    margin-bottom: 0.5rem;
    color: var(--text-color);
    font-size: 0.9rem;
    position: static;
  }
  
  .input-group select[multiple] {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    font-size: 1rem;
    transition: all 0.3s ease;
    min-height: 120px;
    background-color: white;
    margin-top: 0.25rem;
  }
  
  .input-group select[multiple]:focus {
    border-color: var(--primary-color);
    outline: none;
    box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.1);
  }
  
  .input-group select[multiple] option {
    padding: 0.5rem;
    margin: 2px 0;
  }
  
  .input-group select[multiple] option:checked {
    background-color: var(--primary-color);
    color: white;
  }
  
  .input-group select[multiple] option:hover {
    background-color: rgba(37, 99, 235, 0.1);
  }
  
  
    </style>
</head>
<body>
    <div class="container">
        <!-- Welcome Screen -->
        <div id="welcomeScreen" class="welcome-screen">
            <h1 class="welcome-title">Welcome to Task Manager</h1>
            <button class="btn-welcome" onclick="showLoginPage()">
                Get Started
                <span class="arrow">→</span>
            </button>
        </div>

        <!-- Login Screen -->
        <div id="loginScreen" class="login-screen">
            <div class="form-container">
                <h2 class="form-title">Login</h2>
                <form id="loginForm">
                    <div class="input-group">
                        <input type="text" id="userId" name="userId" required>
                        <label for="userId">User ID</label>
                    </div>
                    <div class="input-group">
                        <input type="password" id="password" name="password" required>
                        <label for="password">Password</label>
                    </div>
                    <button type="submit" class="btn-submit">Login</button>
                </form>
                <p class="signup-text">
                    Don't have an account? 
                    <button class="btn-link" onclick="showSignupPage()">Sign up here</button>
                </p>
            </div>
        </div>

        <!-- Signup Screen -->
        <div id="signupScreen" class="signup-screen hidden">
            <div class="form-container">
                <h2 class="form-title">Create Account</h2>
                <form id="signupForm">
                    <div class="input-group">
                        <input type="text" id="name" name="name" required placeholder=" ">
                        <label for="name">Full Name</label>
                    </div>
                    <div class="input-group">
                        <input type="text" id="newUserId" name="newUserId" required placeholder=" ">
                        <label for="newUserId">User ID</label>
                    </div>
                    <div class="input-group">
                        <select id="role" name="role" required>
                            <option value="">Select Role</option>
                            <option value="employee">Employee</option>
                            <option value="manager">Manager</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <input type="text" id="designation" name="designation" required placeholder=" ">
                        <label for="designation">Designation</label>
                    </div>
                    <div class="input-group">
                        <input type="text" id="skills" name="skills" required placeholder=" ">
                        <label for="skills">Skills (comma-separated)</label>
                    </div>
                    <div class="input-group">
                        <label for="departments" class="select-label">Departments (Hold Ctrl/Cmd to select multiple)</label>
                        <select id="departments" name="departments" multiple required>
                            <option value="Sales">Sales</option>
                            <option value="Design">Design</option>
                            <option value="Purchase">Purchase</option>
                            <option value="Accounts">Accounts</option>
                            <option value="Marketing">Marketing</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <input type="email" id="email" name="email" required placeholder=" ">
                        <label for="email">Email</label>
                    </div>
                    <div class="input-group">
                        <input type="password" id="newPassword" name="newPassword" required placeholder=" ">
                        <label for="newPassword">Password</label>
                    </div>
                    <div class="input-group">
                        <input type="password" id="confirmPassword" name="confirmPassword" required placeholder=" ">
                        <label for="confirmPassword">Confirm Password</label>
                    </div>
                    <button type="submit" class="btn-submit">Create Account</button>
                </form>
                <button class="btn-back" onclick="showLoginPage()">
                    ← Back to Login
                </button>
            </div>
        </div>
    </div>
    <script>
        // Define navigation functions in global scope
function showLoginPage() {
    document.getElementById("welcomeScreen").classList.add("hidden")
    document.getElementById("signupScreen").classList.add("hidden")
    document.getElementById("loginScreen").classList.remove("hidden")
  }
  
  function showSignupPage() {
    document.getElementById("welcomeScreen").classList.add("hidden")
    document.getElementById("loginScreen").classList.add("hidden")
    document.getElementById("signupScreen").classList.remove("hidden")
  }
  
  function showWelcomePage() {
    document.getElementById("loginScreen").classList.add("hidden")
    document.getElementById("signupScreen").classList.add("hidden")
    document.getElementById("welcomeScreen").classList.remove("hidden")
  }
  
  document.addEventListener("DOMContentLoaded", () => {
    // Get form elements
    const loginForm = document.getElementById("loginForm")
    const signupForm = document.getElementById("signupForm")
    const showSignupButton = document.getElementById("showSignup")
    const closeSignupButton = document.getElementById("closeSignup")
    const signupPopup = document.getElementById("signupPopup")
  
    // Handle Login Form
    if (loginForm) {
      loginForm.addEventListener("submit", async (e) => {
        e.preventDefault()
        
        const userId = document.getElementById("userId").value
        const password = document.getElementById("password").value
  
        try {
          const response = await fetch("/api/login", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ userId, password }),
          })
  
          const data = await response.json()
  
          if (data.success) {
            // Store user data in sessionStorage
            sessionStorage.setItem("userId", userId)
            sessionStorage.setItem("userRole", data.role)
  
            // Redirect based on role
            if (data.role === "manager") {
              window.location.href = "/manager-dashboard"
            } else {
              window.location.href = "/employee-dashboard"
            }
          } else {
            alert(data.message || "Login failed")
          }
        } catch (error) {
          console.error("Login error:", error)
          alert("An error occurred during login")
        }
      })
    }
  
    // Handle Signup Form
    if (signupForm) {
      signupForm.addEventListener("submit", async (e) => {
        e.preventDefault()
        const password = document.getElementById("newPassword").value
        const confirmPassword = document.getElementById("confirmPassword").value
  
        if (password !== confirmPassword) {
          alert("Passwords do not match!")
          return
        }
  
        // Get selected departments
        const departmentsSelect = document.getElementById("departments")
        const selectedDepartments = Array.from(departmentsSelect.selectedOptions).map(option => option.value)
  
        const formData = {
          name: document.getElementById("name").value,
          userId: document.getElementById("newUserId").value,
          role: document.getElementById("role").value,
          designation: document.getElementById("designation").value,
          skills: document.getElementById("skills").value,
          departments: selectedDepartments, // Send as array
          email: document.getElementById("email").value,
          password: password,
        }
  
        try {
          const response = await fetch("/api/signup", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(formData),
          })
  
          const data = await response.json()
  
          if (data.success) {
            alert("Account created successfully! Please login.")
            showLoginPage()
          } else {
            alert(data.message || "Error creating account. Please try again.")
          }
        } catch (error) {
          console.error("Signup error:", error)
          alert("An error occurred during signup. Please try again.")
        }
        signupPopup.style.display = "none"
      })
    }
  
    showSignupButton.addEventListener("click", () => {
      signupPopup.style.display = "flex"
    })
  
    closeSignupButton.addEventListener("click", () => {
      signupPopup.style.display = "none"
    })
  
    // Close the popup if clicking outside of it
    signupPopup.addEventListener("click", (e) => {
      if (e.target === signupPopup) {
        signupPopup.style.display = "none"
      }
    })
  
    // Add input animation handlers
    const inputs = document.querySelectorAll("input")
    inputs.forEach((input) => {
      input.setAttribute("placeholder", " ")
    })
  })
  
  
    </script>
</body>
</html>

